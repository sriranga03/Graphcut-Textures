
Description:

# Image blending following graphcuts with Edmond-karp Algorithm

The code is an implementation of  the [paper](https://www.cc.gatech.edu/~turk/my_papers/graph_cuts.pdf) "Graphcut Textures: Image and Video Synthesis Using Graph Cuts" by Kwatra et al.

## Installation

The implementation is in Python 3.

Required packages are mentioned in the requirements.txt, they can be downloaded as :
```
pip3 install -r python_requirements.txt
```
The `networkx` library is used for graph plotting.

## Running

cd <directory of this code>
Run graph cuts with the following command:
```
python graph_cuts.py -i <path-to-image-directory>
```
The image directory should have three images, `src.jpg`,`target.jpg` and `mask.jpg`. 


## Statement of Help
 
This section deals with the brief explanation of algorithm and the  interpretation of the generated outputs from the code
Let's start with the inputs for the algorithm. We have to given source, target and mask images to the input to get composite image as output.
  
The following is the source image   (image patch  will be taken from here)
  
  ![src](https://user-images.githubusercontent.com/102194740/165442941-8b3a6c25-679f-4c02-8f59-8938ec842191.jpg)

  
The  following is the target image  (image patch taken from the source will be  added here)
  
  ![target](https://user-images.githubusercontent.com/102194740/165442988-e2539c6f-37a9-4abb-8afb-b67c5a487dc0.jpg)

  
The following is the mask ( which is used to generate the cut from the source image)
  
  ![mask](https://user-images.githubusercontent.com/102194740/165443022-d074f37e-4571-40a2-9ff7-c5c1510103b8.png)

  
  
The Image_blending class when given the above images as input creates the graph and computes the max-flow using Edmond-karp algorithm
  
The goal is to generate an composite image of the source and target image  based on the mask given
  
The following output under label `image_showing_overlap.png`is a Single image showing overlap based on the given mask
  
  ![image_showing_overlap](https://user-images.githubusercontent.com/102194740/165443072-63db0ef3-8f47-4af7-a2ec-1558f6dd10e7.png)

  
#Converting solution to image cut
  
 The highlighted part in the following output `sol_to_image_cut.png` shows the  segmentation pixels retrieved from the graph cut. This part will be cut and will be blended with the target image to get the desired composite output
  
 ![sol_to_image_cut](https://user-images.githubusercontent.com/102194740/165443181-9737df7a-eb2e-4607-b740-7f3dff357f15.png)

  
 The `vector_of_the_pixels_identified_as_cut.txt` file is generated by the code which has the  vector of the pixels which are identified as cut.
 
 The  `adjacency_matrix.txt` file is the text file containing adjacency list. The following screenshot of the adjacency matrix is added in the images/garden folder
 
 ![adjacency_list_screen_Shot](https://user-images.githubusercontent.com/102194740/165431316-67e05f5b-e2a3-46e6-802e-7feaeb293bb8.png)

 #Note: The lines that generate the adjacency list are commented as it requires a lot of memory due to networkx library. In my pc the memory was not sufficient so I ran in the google colab, if python stoped working error occurs please execute it in colab
  
 The  `result.png` is the final composite image i.e a blended image of the given source and target according to the mask
 
  ![result](https://user-images.githubusercontent.com/102194740/165443226-d0b2735f-498f-4281-ba71-d93cadb7a325.png)

  
  
  
  
  
  

  ## References :
  
  
 1. https://github.com/niranjantdesai/image-blending-graphcuts

 2. https://stackoverflow.com/questions/29106702/blend-overlapping-images-in-python



  
  

  



  
